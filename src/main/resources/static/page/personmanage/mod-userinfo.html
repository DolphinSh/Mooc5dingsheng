<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>人员管理</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="../../lib/layui-v2.5.5/css/layui.css" media="all">
    <link rel="stylesheet" href="../../lib/font-awesome-4.7.0/css/font-awesome.min.css" media="all">
    <link rel="stylesheet" href="../../css/public.css" media="all">
</head>
<body>
<form class="layui-form" lay-filter="dept-userModFrom" id="dept-userModFrom" >
    <div class="layui-form-item">
        <label class="layui-form-label">用户名</label>
        <div class="layui-input-block">
            <input type="text" id="admin_account" name="title" required  lay-verify="required" placeholder="请输入用户名" autocomplete="off" class="layui-input" >
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">性别</label>
        <div class="layui-input-block">

            <input id="admin_gender_man" type="radio" name="sex" value="1" title="男" checked="">
            <input id="admin_gender_woman" type="radio" name="sex" value="2" title="女">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">年龄</label>
        <div class="layui-input-block">
            <input type="text" id="admin_age" name="title" required  lay-verify="required" placeholder="请输入年龄" autocomplete="off" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">一级部门</label>
        <div class="layui-input-block">
            <select name="firstDept" id="firstDept" lay-verify="required">
                <option value=""></option>

            </select>
        </div>
        <label class="layui-form-label">二级部门</label>
        <div class="layui-input-block">
            <select name="secondDept" id="secondDept" lay-verify="required">
                <option value=""></option>
            </select>
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">启用状态</label>
        <div class="layui-input-block">
            <input type="checkbox" name="switch" lay-skin="switch">
        </div>
    </div>
    <div class="layui-form-item">
        <div class="layui-input-block">
            <button class="layui-btn" lay-submit lay-filter="formDemo">立即提交</button>
            <button type="reset" class="layui-btn layui-btn-primary">重置</button>
        </div>
    </div>
</form>

<script src="../../lib/layui-v2.5.5/layui.js" charset="utf-8"></script>

<script>

        layui.use(['jquery', 'form', 'layer'], function () {
            var form = layui.form;
            var layer = layui.layer;
            var $ = layui.jquery;
            console.log(getQueryParam("admin_account"));
            selectParentName()
            /*selectSecondName()*/
            var info = $("#secondDept").val();
            console.log("当前选中值"+info);
            // 获取一级子部门
            function selectParentName(){
                $.ajax({
                    type:'GET',
                    url:'/page/personmanage/getParentSection',
                    dataType:"json",
                    success: function(data){
                        if(data != null){
                            var add=document.getElementById("firstDept");
                            for(var i=0;i<data.length;i++){
                                var option=document.createElement("option");
                                option.id= i;
                                option.innerText=data[i].section_name;
                                add.append(option);
                                layui.form.render('select')
                            }
                        }else{
                            layer.msg('暂时没有分类，请新建项目分类')
                        }
                    }
                });
            }

            /**
             * 获取二级子部门
             */
            function selectSecondName(data){

                $.ajax({
                    type:'GET',
                    url:'/page/personmanage/getSecondDeptName?send_name=',
                    dataType:"json",
                    success: function(data){
                        console.log("请求的二级子部门"+data)
                        if(data != null){
                            var add=document.getElementById("secondDept");
                            for(var i=0;i<data.length;i++){
                                alert(i +"--"+data[i].section_name);
                                var option=document.createElement("option");
                                option.id= i;
                                option.innerText=data[i].section_name;
                                add.append(option);
                                layui.form.render('select')
                            }
                        }else{
                            layer.msg('暂时没有分类，请新建项目分类')
                        }
                    }
                });
            }

        });

    function getQueryParam(parameter)
    {
        var query = window.location.search.substring(1);
        var vars = query.split("&");
        for (var i=0;i<vars.length;i++) {
            var pair = vars[i].split("=");
            if(pair[0] == parameter){return pair[1];}
        }
        return(false);
    }
</script>
</body>
</html>